{% from "moj/components/primary-navigation/macro.njk" import mojPrimaryNavigation %}

{% set isUserInPdcTeam = false %}
{% for team in user.teams %}
  {% if not isUserInPdcTeam %}
    {% set isUserInPdcTeam = team.id == "PDC_READ" or team.id == "PDC_RECONCILE" %}
  {% endif %}
{% endfor %}

{% set bankReportsNavItem = {
  text: "Bank reports",
  href: "/utilisation-reports",
  active: (activePrimaryNavigation == "utilisation reports"),
  attributes: {
    "data-cy": "bank-reports-nav-link"
  }
} %}

{% set allDealsNavItem = {
  text: "All deals",
  href: "/deals",
  active: (activePrimaryNavigation == "all deals"),
  attributes: {
    "data-cy": "all-deals-nav-link"
  }
} %}

{% set allFacilitiesNavItem = {
  text: "All facilities",
  href: "/facilities",
  active: (activePrimaryNavigation == "all facilities"),
  attributes: {
    "data-cy": "all-facilities-nav-link"
  }
} %}

{% set navItems = [] %}

{% if user and isUserInPdcTeam %}
  {% set navItems = [bankReportsNavItem, allDealsNavItem, allFacilitiesNavItem] %}
{% elif user %}
  {% set navItems = [allDealsNavItem, allFacilitiesNavItem] %}
{% endif %}

{% if navItems.length %}
  {{ mojPrimaryNavigation({
    label: "Primary navigation",
    items: navItems
  }) }}
{% endif %}
