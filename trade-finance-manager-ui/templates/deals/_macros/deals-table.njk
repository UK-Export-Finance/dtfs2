{% macro render(params) %}
  {% set deals = params.deals %}
  <table class="govuk-table" data-cy="deals-table">
    <thead class="govuk-table__head">
      <tr>
        <th class="govuk-table__header govuk-body-s" data-cy="deals-table-heading-tasks">Tasks</th>
        <th class="govuk-table__header govuk-body-s" data-cy="deals-table-heading-deal-id">deal ID</th>
        <th class="govuk-table__header govuk-body-s" data-cy="deals-table-heading-product">Product</th>
        <th class="govuk-table__header govuk-body-s" data-cy="deals-table-heading-type">Type</th>
        <th class="govuk-table__header govuk-body-s" data-cy="deals-table-heading-stage">Exporter</th>
        <th class="govuk-table__header govuk-body-s" data-cy="deals-table-heading-tenor">Buyer</th>
        <th class="govuk-table__header govuk-body-s" data-cy="deals-table-heading-cover-end-date">Bank</th>
        <th class="govuk-table__header govuk-body-s" data-cy="deals-table-heading-value-export-currency">Date</th>
      </tr>
    </thead>

    <tbody class="govuk-table__body">
      {% for deal in deals %}
        <tr class="govuk-table__row" data-cy="deal-{{ deal._id }}">
          <td class="govuk-table__cell govuk-body-s" data-cy="deal-{{ deal._id }}-tasks"></td>
          <td class="govuk-table__cell govuk-body-s">
            <a
              class="govuk-link"
              href="/case/deal/{{ deal._id }}"
              aria-label="View deal details"
              data-cy="deal-{{ deal._id }}-ukef-deal-id-link">
              <span data-cy="deal-{{ deal._id }}-ukef-deal-id-link-text">{{ deal._id }}</span>
            </a>
          </td>
          <td class="govuk-table__cell govuk-body-s" data-cy="deal-{{ deal._id }}-product">{{ deal.Product | dashIfEmpty }}</td>
          <td class="govuk-table__cell govuk-body-s" data-cy="deal-{{ deal._id }}-type">{{ deal.details.submissionType | dashIfEmpty}}</td>
          <td class="govuk-table__cell govuk-body-s" data-cy="deal-{{ deal._id }}-exporterName">{{ deal.submissionDetails.supplierName | dashIfEmpty}}</td>
          <td class="govuk-table__cell govuk-body-s" data-cy="deal-{{ deal._id }}-buyerName">{{ deal.submissionDetails.buyerName | dashIfEmpty}}</td>
          <td class="govuk-table__cell govuk-body-s" data-cy="deal-{{ deal._id }}-bank">{{ deal.details.owningBank.name | dashIfEmpty }}</td>
          <td class="govuk-table__cell govuk-body-s" data-cy="deal-{{ deal._id }}-date-received">{{ deal.details.submissionDate | localiseTimestamp("D MMMM YYYY", 'en-gb') }}</td>
        </tr>
      {% endfor %}
    </tbody>

  </table>

{% endmacro %}
