{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% import './_macros/managers-decision-submitted.njk' as managersDecisionSubmitted %}

{% macro render(params) %}

  {% set underwriterManagerDecision = params.amendmentUnderwriterManagersDecision %}

  {% block underwriting_content %}

    <div class="govuk-grid-row">

      <div class="govuk-grid-column-three-quarters">

        {% if underwriterManagerDecision.underwriterManagersDecision.decision %}

          {% set managersDecisionSubmittedComponentData = {
            decision: underwriterManagerDecision.underwriterManagersDecision.decision,
            user: underwriterManagerDecision.underwriterManagersDecision.user
          } %}

          {{managersDecisionSubmitted.render(managersDecisionSubmittedComponentData)}}

        {% else %}

          {% if underwriterManagerDecision.isEditable %}
            <div class="govuk-!-padding-top-0">
              {{ govukButton({
                  text: "Add decision",
                  href: "/case/" + underwriterManagerDecision.dealId + "/facility/" + underwriterManagerDecision.facilityId + "/amendment/" + underwriterManagerDecision.amendmentId + "/managers-decision",
                  attributes: {
                    "data-cy":"amendment-manager-add-decision-link"
                  }
                }) }}
            </div>
          {% else %}

            <p class="govuk-!-margin-top-0" data-cy="amendment-manager-decision-not-added-readonly">Not added yet</p>

          {% endif %}


        {% endif %}

      </div>

    </div>

  {% endblock %}

{% endmacro %}