{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% import './_macros/managers-decision-form.njk' as managersDecisionForm %}
{% import './_macros/managers-decision-submitted.njk' as managersDecisionSubmitted %}

{% extends "index.njk" %}

{% block content %}
  <section class="govuk-!-margin-top-9"> 

    {% if validationErrors.count %}
      {{
        govukErrorSummary({
          titleText: "There is a problem",
          errorList: validationErrors.summary,
          attributes: {
            'data-cy': 'error-summary'
          }
        })  
      }}
    {% endif %}

    <div class="govuk-grid-row">

      <div class="govuk-grid-column-three-quarters">

        <h3 class="govuk-heading-l ukef-heading-grey govuk-!-margin-bottom-3" data-cy="managers-decision-heading">Underwriter managerâ€™s decision</h3>

        {% if decisionSubmitted %}

          {% set managersDecisionSubmittedComponentData = {
            caseId: dealId,
            managersDecision: tfm.managersDecision
          } %}

          {{managersDecisionSubmitted.render(managersDecisionSubmittedComponentData)}}

        {% else %}

          {% set managersDecisionFormComponentData = {
            caseId: dealId,
            validationErrors: validationErrors
          } %}

          {{managersDecisionForm.render(managersDecisionFormComponentData)}}
        {% endif %}

      </div>

    </div>

  </section>

{% endblock %}
