{% from "govuk/components/tag/macro.njk" import govukTag %}

{% macro render(params) %}
  {% set caseId = params.caseId %}
  {% set exporterCreditRating = params.exporterCreditRating %}
  {% set lossGivenDefault = params.lossGivenDefault %}
  {% set userCanEdit = params.userCanEdit %}

  <table class="govuk-table govuk-!-margin-bottom-8" data-cy="credit-rating-table">
    <tbody class="govuk-table__body">

      <tr class="govuk-table__row">

        <td scope="row" class="govuk-table__cell width-half govuk-table__cell--border-top" data-cy="credit-rating-table-heading">
          Credit rating
        </td>

        <td class="govuk-table__cell govuk-table__cell--border-top">
          {% if exporterCreditRating %}
            <span data-cy="credit-rating-table-rating-value">{{ exporterCreditRating }}</span>

            {% else %}

            {{ govukTag({
              text: 'Not added',
              classes: 'govuk-tag--yellow',
              attributes: {
                'data-cy': 'credit-rating-table-rating-not-set'
              }
            }) }}

          {% endif %}
        </td>
        
        <td class="govuk-table__cell govuk-table__cell--border-top text-align-right">
          {% if exporterCreditRating and userCanEdit %}
            <a class="govuk-link" href="/case/{{ caseId }}/underwriting/pricing-and-risk/edit" data-cy="credit-rating-table-change-link">Change</a>
          {% endif %}
        </td>

      </tr>

      <tr class="govuk-table__row">

        <td scope="row" class="govuk-table__cell width-half" data-cy="credit-rating-table-loss-given-default-heading">
          Loss given default
        </td>

        <td class="govuk-table__cell" data-cy="credit-rating-table-loss-given-default-value">{{ lossGivenDefault }}</td>
        
      </tr>

      <tr class="govuk-table__row">

        <td scope="row" class="govuk-table__cell width-half">
          Probability of default
        </td>

        <td class="govuk-table__cell">-</td>
        
      </tr>

    </tbody>
  </table>
{% endmacro %}
