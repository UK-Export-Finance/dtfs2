{% macro render(params) %}
  {% set facility = params.facility %}
  {% set schedule = params.premiumschedule %}
  {% set premiumTotals = params.premiumTotals %}
  <div class="govuk-grid-row" data-cy="facility-overview">
    <div class="govuk-grid-column-full">
      <h3 class="govuk-heading-l">Premium Schedule</h3>
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-quarter">
          <h4 class="govuk-heading-s">How bank will pay</h4>
        </div>
        <div class="govuk-grid-column-three-quarters">
          <p class="govuk-body-s" data-cy="facility-premium-type">
            {{ facility.feeType }}
          </p>
        </div>
      </div>



      {% if not facility.feeType == 'At Maturity' %}
        <div class="govuk-grid-row">
          <div class="govuk-grid-column-one-quarter">
            <h4 class="govuk-heading-s">How often</h4>
          </div>
          <div class="govuk-grid-column-three-quarters">
            <p class="govuk-body-s" data-cy="facility-premium-frequency">
              {% if facility.facilityProduct.name =='Bond Support Scheme' %}
                {{ facility.feeFrequency }}
              {% else %}
                {{ facility.premiumFrequency }}
              {% endif %}
            </p>
          </div>
        </div>
      {% endif %}
      <div class="govuk-grid-row">
        <div class="govuk-grid-column-one-quarter">
          <h4 class="govuk-heading-s">Day count basis</h4>
        </div>
        <div class="govuk-grid-column-three-quarters" data-cy="facility-premium-daycountbasis">{{ facility.dayCountBasis }}</div>
      </div>
    </div>
  </div>
  <div class="govuk-grid-row separator-line" data-cy="facility-premium-schedule">
    <div class="govuk-grid-column-two-thirds">
      <h3 class="govuk-heading-l">Dates and amounts</h3>
      <div class="govuk-grid-row ">
        <div class="govuk-grid-column-one-third ukef-grey-bg-row-column-left-text">
          <h4 class="govuk-heading-s">Total to be paid to UKEF:</h4>
        </div>
        <div class="govuk-grid-column-one-quarter ukef-grey-bg-row-column-left-text">
          <h4 class="govuk-heading-s" data-cy="premiumTotals">GBP
            {{ premiumTotals }}</h4>
        </div>
      </div>
      <table class="govuk-table facilities-table" data-cy="facilities-table">
        <thead class="govuk-table__head">
          <tr>
            <th class="govuk-table__header govuk-body-s" data-cy="facilities-table-heading-facility-id">Payment</th>
            <th class="govuk-table__header govuk-body-s" data-cy="facilities-table-heading-cover-end-date">Due date</th>
            <th class="govuk-table__header govuk-body-s" data-cy="facilities-table-heading-value-gbp">Amount to be paid to UKEF (GBP)</th>
          </tr>
        </thead>
        <tbody class="govuk-table__body">
          {% for schedule_item in schedule %}
            <tr class="govuk-table__row" data-cy="schedule_item-{{ schedule_item.id }}">
              <td class="govuk-table__cell govuk-body-s" data-cy="facility-{{ schedule_item._id }}-payment">{{ schedule_item.period }}</td>
              <td class="govuk-table__cell govuk-body-s" data-cy="facility-{{ schedule_item._id }}-dueDate">{{ schedule_item.calculationDate | dashIfEmpty }}</td>
              <td class="govuk-table__cell govuk-body-s" data-cy="facility-{{ schedule_item._id }}-amount">{{ schedule_item.formattedIncome }}</td>
            </tr>
          {% endfor %}
        </tbody>
        <tfoot>
          <tr>
            <td class="govuk-table__cell govuk-body-s govuk-!-font-weight-bold"></td>
            <td class="govuk-table__cell govuk-body-s govuk-!-font-weight-bold"></td>
            <td class="govuk-table__cell govuk-body-s govuk-!-font-weight-bold" data-cy="premiumTotals">Total:
              {{ premiumTotals }}</td>
          </tr>
        </tfoot>
      </table>
    </div>
  {% endmacro %}