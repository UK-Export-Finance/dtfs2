{% extends "case/case.njk" %}
{% from "govuk/components/tag/macro.njk" import govukTag %}

{% block sub_content %}
  
  <div class="govuk-grid-row" data-cy="deal-tasks">

    <div class="govuk-grid-column-three-quarters">

      <h2 class="govuk-heading-xl govuk-!-margin-top-6">Tasks for this deal</h2>

      <h3 class="govuk-heading-s ukef-heading-background">{{ deal.details.submissionType }}</h3>

      <table class="govuk-table" data-cy="tasks-list">
        <thead class="govuk-table__head">
          <tr>
            <th class="govuk-table__header"></th>
            <th class="govuk-table__header">Assigned to</th>
            <th class="govuk-table__header">Team</th>
            <th class="govuk-table__header"></th>
          </tr>
        </thead>

        <tbody class="govuk-table__body">
          {% for task in tfm.tasks %}
            <tr class="govuk-table__row" data-cy="task-{{ task.id }}-row">

              <td class="govuk-table__cell">
                <a href="/case/{{ dealId }}/tasks/{{ task.id }}" data-cy="task-{{ task.id }}-link">{{ task.title}}</a>
              </td>

              <td class="govuk-table__cell">
                {{ task.assignedTo.userFullName }}
              </td>

              <td class="govuk-table__cell">
                {{ task.team.name }}
              </td>

              <td class="govuk-table__cell" aria-labelledby="Task status">
                {{govukTag({
                  text: task.status,
                  attributes: {
                    'data-cy': 'status-tag'
                  }
                })}}

              </td>

            </tr>
          {% endfor %}
        </tbody>
      </table>

    </div>

  </div>

{% endblock %}
