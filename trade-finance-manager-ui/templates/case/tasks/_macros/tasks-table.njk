{% import './task-status-tag.njk' as taskStatusTag %}

{% macro render(params) %}
  {% set caseId = params.caseId %}
  {% set tasks = params.tasks %}

  <table class="govuk-table" data-cy="tasks-table">
    <thead class="govuk-table__head">
      <tr>
        <th class="govuk-table__header"></th>
        <th class="govuk-table__header" data-cy="tasks-table-header-assigned-to">Assigned to</th>
        <th class="govuk-table__header" data-cy="tasks-table-header-team">Team</th>
        <th class="govuk-table__header"></th>
      </tr>
    </thead>

    <tbody class="govuk-table__body">
      {% for task in tasks %}
        <tr class="govuk-table__row" data-cy="task-{{ task.id }}-row">

          <td class="govuk-table__cell">
            <a class="govuk-link" href="/case/{{ caseId }}/tasks/{{ task.id }}" data-cy="task-{{ task.id }}-link">{{ task.title}}</a>
          </td>

          <td class="govuk-table__cell" data-cy="task-table-row-{{ task.id }}-user-full-name">
            {{ task.assignedTo.userFullName }}
          </td>

          <td class="govuk-table__cell" data-cy="task-table-row-{{ task.id }}-team-name">
            {{ task.team.name }}
          </td>

          <td class="govuk-table__cell" aria-labelledby="Task status">
            {% set componentData = {
              status: task.status
            } %}

            {{taskStatusTag.render(componentData)}}
          </td>

        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endmacro %}
