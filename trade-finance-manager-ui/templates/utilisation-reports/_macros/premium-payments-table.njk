{% from "govuk/components/button/macro.njk" import govukButton %}
{% import "./fee-record-status.njk" as feeRecordStatus %}
{% import "../../_macros/table-cell-checkbox.njk" as tableCellCheckbox %}
{% import "../../_macros/select-all-table-cell-checkbox.njk" as selectAllTableCellCheckbox %}

{% macro render(params) %}
  {% set feeRecords = params.feeRecords %}

  <table class="govuk-table" data-module="moj-sortable-table" data-cy="premium-payments-table">
    <thead class="govuk-table__head">
      <tr class="govuk-table__row">
        <th scope="col" class="govuk-table__header" aria-sort="ascending">Facility ID</th>
        <th scope="col" class="govuk-table__header" aria-sort="none">Exporter</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric" aria-sort="none">Reported fees</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric" aria-sort="none">Reported payments</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric" aria-sort="none">Total reported payments</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric" aria-sort="none">Payments received</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric" aria-sort="none">Total payments received</th>
        <th scope="col" class="govuk-table__header" aria-sort="none">Status</th>
        <th scope="col" class="govuk-table__header">
          {{ selectAllTableCellCheckbox.render() }}
        </th>
      </tr>
    </thead>

    <tbody class="govuk-table__body">
    {% for feeRecord in feeRecords %}
      <tr
        class="govuk-table__row"
        data-cy="premium-payments-table-row--feeRecordId-{{ feeRecord.id }}"
      >
        <th
          scope="row"
          class="govuk-table__header govuk-!-font-weight-regular"
          data-sort-value="{{ feeRecord.facilityId }}"
        >
          {{ feeRecord.facilityId }}
        </th>
        <td class="govuk-table__cell" data-sort-value="{{ feeRecord.exported }}">
          {{ feeRecord.exporter }}
        </td>
        <td class="govuk-table__cell govuk-table__cell--numeric" data-sort-value="{{ feeRecord.reportedFees.dataSortValue }}">
          {{ feeRecord.reportedFees.formattedCurrencyAndAmount }}
        </td>
        <td class="govuk-table__cell govuk-table__cell--numeric" data-sort-value="{{ feeRecord.reportedPayments.dataSortValue }}">
          {{ feeRecord.reportedPayments.formattedCurrencyAndAmount }}
        </td>
        <td class="govuk-table__cell govuk-table__cell--numeric" data-sort-value="{{ feeRecord.totalReportedPayments.dataSortValue }}">
          {{ feeRecord.totalReportedPayments.formattedCurrencyAndAmount }}
        </td>
        <td class="govuk-table__cell govuk-table__cell--numeric" data-sort-value="{{ feeRecord.paymentsReceived.dataSortValue }}">
          {{ feeRecord.paymentsReceived.formattedCurrencyAndAmount }}
        </td>
        <td class="govuk-table__cell govuk-table__cell--numeric" data-sort-value="{{ feeRecord.totalPaymentsReceived.dataSortValue }}">
          {{ feeRecord.totalPaymentsReceived.formattedCurrencyAndAmount }}
        </td>
        <td class="govuk-table__cell" data-sort-value="{{ feeRecord.displayStatus }}">
          {{ feeRecordStatus.render({
            status: feeRecord.status,
            displayStatus: feeRecord.displayStatus
          }) }}
        </td>
        <td class="govuk-table__cell">
          {% if feeRecord.status === 'TO_DO' or feeRecord.status === 'DOES_NOT_MATCH' %}
            {{ tableCellCheckbox.render({
              checkboxId: feeRecord.checkboxId,
              checked: feeRecord.isChecked
            }) }}
          {% endif %}
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
{% endmacro %}
