const { add, sub } = require('date-fns');
const { CURRENCY, FACILITY_PROVIDED_DETAILS, FACILITY_TYPE, isFacilityEndDateEnabledOnGefVersion, getCurrentGefDealVersion } = require('@ukef/dtfs2-common');

/**
 * Gets facility end date properties if enabled on default deal version
 * @returns {Pick<import('@ukef/dtfs2-common').Facility,'isUsingFacilityEndDate' | 'facilityEndDate'> | {} } mock facility end date properties if enabled, or empty object if not
 */
const getFacilityEndDateProperties = () => {
  if (isFacilityEndDateEnabledOnGefVersion(getCurrentGefDealVersion())) {
    return {
      isUsingFacilityEndDate: true,
      facilityEndDate: add(new Date(), { months: 2 }),
    };
  }
  return {};
};

const FACILITIES = [
  [],
  [
    {
      type: FACILITY_TYPE.CASH,
      hasBeenIssued: true,
      name: null,
      startOnDayOfNotice: null,
      shouldCoverStartOnSubmission: null,
      coverStartDate: null,
      coverEndDate: null,
      monthsOfCover: null,
      details: null,
      detailsOther: null,
      currency: null,
      value: null,
      coverPercentage: null,
      interestPercentage: null,
      paymentType: null,
    },
    {
      type: FACILITY_TYPE.CASH,
      hasBeenIssued: false,
      name: null,
      startOnDayOfNotice: null,
      shouldCoverStartOnSubmission: null,
      coverStartDate: null,
      coverEndDate: null,
      monthsOfCover: null,
      details: null,
      detailsOther: null,
      currency: null,
      value: null,
      coverPercentage: null,
      interestPercentage: null,
      paymentType: null,
    },
  ],
  [
    {
      ...getFacilityEndDateProperties(),
      type: FACILITY_TYPE.CASH,
      hasBeenIssued: true,
      name: 'This Cash facility 1',
      startOnDayOfNotice: true,
      shouldCoverStartOnSubmission: false,
      coverStartDate: new Date(),
      coverEndDate: add(new Date(), { months: 1 }),
      monthsOfCover: 18,
      details: [FACILITY_PROVIDED_DETAILS.COMMITTED, FACILITY_PROVIDED_DETAILS.FACTORING],
      detailsOther: null,
      currency: { id: CURRENCY.GBP },
      value: 1000000,
      coverPercentage: 60,
      interestPercentage: 30,
      paymentType: 'Monthly',
      feeType: 'In advance',
      feeFrequency: 'Monthly',
      dayCountBasis: '365',
    },
    {
      ...getFacilityEndDateProperties(),
      type: FACILITY_TYPE.CASH,
      hasBeenIssued: false,
      name: 'That Cash facility 2',
      startOnDayOfNotice: true,
      shouldCoverStartOnSubmission: true,
      coverStartDate: null,
      coverEndDate: null,
      monthsOfCover: 6,
      details: [
        FACILITY_PROVIDED_DETAILS.TERM,
        FACILITY_PROVIDED_DETAILS.RESOLVING,
        FACILITY_PROVIDED_DETAILS.COMMITTED,
        FACILITY_PROVIDED_DETAILS.UNCOMMITTED,
        FACILITY_PROVIDED_DETAILS.ON_DEMAND,
        FACILITY_PROVIDED_DETAILS.FACTORING,
        FACILITY_PROVIDED_DETAILS.OTHER,
      ],
      detailsOther: 'Other',
      currency: { id: CURRENCY.EUR },
      value: 18000000,
      coverPercentage: 40,
      interestPercentage: 0.1,
      paymentType: 'Monthly',
      feeType: 'In advance',
      feeFrequency: 'Monthly',
      dayCountBasis: '365',
    },
    {
      ...getFacilityEndDateProperties(),
      type: FACILITY_TYPE.CONTINGENT,
      hasBeenIssued: true,
      name: 'This Contingent facility 1',
      startOnDayOfNotice: false,
      shouldCoverStartOnSubmission: false,
      coverStartDate: sub(new Date(), { days: 1 }),
      coverEndDate: add(new Date(), { months: 1 }),
      monthsOfCover: 48,
      details: [FACILITY_PROVIDED_DETAILS.OTHER],
      detailsOther: 'This is the other description',
      currency: { id: CURRENCY.JPY },
      value: 30000000,
      coverPercentage: 20,
      interestPercentage: 50.9,
      paymentType: 'Monthly',
      feeType: 'In advance',
      feeFrequency: 'Monthly',
      dayCountBasis: '365',
    },
    {
      ...getFacilityEndDateProperties(),
      type: FACILITY_TYPE.CONTINGENT,
      hasBeenIssued: false,
      name: 'This Contingent facility 2',
      startOnDayOfNotice: false,
      shouldCoverStartOnSubmission: false,
      coverStartDate: null,
      coverEndDate: null,
      monthsOfCover: 48,
      details: [FACILITY_PROVIDED_DETAILS.OTHER],
      detailsOther: 'This is the other description',
      currency: { id: CURRENCY.JPY },
      value: 30000000,
      coverPercentage: 20,
      interestPercentage: 50.9,
      paymentType: 'Quarterly',
      feeType: 'In advance',
      feeFrequency: 'Quarterly',
      dayCountBasis: '365',
    },
  ],
];

module.exports = FACILITIES;
