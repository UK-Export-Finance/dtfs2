{% macro render(loanDetails) %}

  <h2 class="govuk-heading-m">Loan guarantee details</h2>

  <dl class="govuk-summary-list govuk-summary-list--no-border">

    {% if loanDetails.bankReferenceNumber %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Bank reference number
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="bank-reference-number">
          {{ loanDetails.bankReferenceNumber }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.facilityStage %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Facility stage
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="facility-stage">
          {{ loanDetails.facilityStage }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.ukefGuaranteeLengthInMonths %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Length of time that the UKEF's guarantee will be in place for (in months, rounded up)
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="ukef-guarantee-length-in-months">
          {{ loanDetails.ukefGuaranteeLengthInMonths }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails['requestedCoverStartDate-day'] and loanDetails['requestedCoverStartDate-month'] and loanDetails['requestedCoverStartDate-year'] %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Requested Cover Start Date
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="requested-cover-start-date">
          {{ loanDetails['requestedCoverStartDate-day'] }}/{{ loanDetails['requestedCoverStartDate-month'] }}/{{ loanDetails['requestedCoverStartDate-year'] }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails['coverEndDate-day'] and loanDetails['coverEndDate-month'] and loanDetails['coverEndDate-year'] %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Requested Cover Start Date
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="cover-end-date">
          {{ loanDetails['coverEndDate-day'] }}/{{ loanDetails['coverEndDate-month'] }}/{{ loanDetails['coverEndDate-year'] }}
        </dd>
      </div>
    {% endif %}

  </dl>

  <h2 class="govuk-heading-m">Loan financial details</h2>

  <dl class="govuk-summary-list govuk-summary-list--no-border">

    {% if loanDetails.loanFacilityValue %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Loan facility value
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="loan-facility-value">
          {{ loanDetails.loanFacilityValue }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.currencySameAsSupplyContractCurrency %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Is the currency of this loan the same as your Supply Contract currency?
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="currency-same-as-supply-contract-currency">
          {% if loanDetails.currencySameAsSupplyContractCurrency === "true" %}
            Yes
          {% elif loanDetails.currencySameAsSupplyContractCurrency === "false" %}
            No
          {% endif %}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.currency %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Currency
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="currency">
          {{ loanDetails.currency }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.conversionRate %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Conversion rate to the supply contract currency
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="conversion-rate">
          {{ loanDetails.conversionRate }}
        </dd>
      </div>
    {% endif %}
    
    {% if loanDetails['conversionRateDate-day'] and loanDetails['conversionRateDate-month'] and loanDetails['conversionRateDate-year'] %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Conversion rate date
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="conversion-rate-date">
          {{ loanDetails['conversionRateDate-day'] }}/{{ loanDetails['conversionRateDate-month'] }}/{{ loanDetails['conversionRateDate-year'] }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.interestMargin %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Interest Margin %
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="interest-margin">
          {{ loanDetails.interestMargin }}%
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.coveredPercentage %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Covered Percentage
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="covered-percentage">
          {{ loanDetails.coveredPercentage }}%
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.minimumQuarterlyFee %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Minimum quarterly fee 
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="minimim-quarterly-fee">
          {{ loanDetails.minimumQuarterlyFee  }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.guaranteeFeePayableByBank %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Guarantee fee payable by bank
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="guarantee-fee-payable-by-bank">
          {{ loanDetails.guaranteeFeePayableByBank }}%
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.ukefExposure %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          UKEF Exposure
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="ukef-exposure">
          {{ loanDetails.ukefExposure }}
        </dd>
      </div>
    {% endif %}

  </dl>

  <h2 class="govuk-heading-m">Dates and repayments</h2>

  <dl class="govuk-summary-list govuk-summary-list--no-border">

    {% if loanDetails.premiumType %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Premium type
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="premium-type">
          {{ loanDetails.premiumType }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.premiumType %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Premium frequency
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="premium-frequency">
          {{ loanDetails.premiumFrequency }}
        </dd>
      </div>
    {% endif %}

    {% if loanDetails.dayCountBasis %}
      <div class="govuk-summary-list__row">
        <dt class="govuk-summary-list__key govuk-body-s">
          Day count basis 
        </dt>
        <dd class="govuk-summary-list__value govuk-body-s" data-cy="day-count-basis">
          {{ loanDetails.dayCountBasis  }}
        </dd>
      </div>
    {% endif %}

  </dl>

{% endmacro %}
