{% extends "index.njk" %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% import './_macros/loan-nav.njk' as loanNav %}
{% import '../_macros/facility-inputs/facility-payment-type.njk' as facilityPaymentType %}
{% import '../_macros/facility-inputs/day-count-radios.njk' as dayCountRadios %}

{% block pageTitle %}Loan Dates and Repayments{% endblock %}

{% block content %}

  {% if validationErrors.count %}
    {{
      govukErrorSummary({
        titleText: "There is a problem",
        errorList: validationErrors.summary
      })
    }}
  {% endif %}

  {{ loanNav.render(
    completedForms = completedForms,
    current = 'loanDatesRepayments',
    contractId = dealId,
    childId = loan._id
  )}}

  <hr class="govuk-section-break govuk-section-break--visible govuk-!-margin-bottom-8" />

  <form method="POST" autocomplete="off">

    <div class="govuk-grid-row">

      <div class="govuk-grid-column-three-quarters">

        {{facilityPaymentType.render(
          id = 'premiumType',
          label = 'Premium type',
          checkedValue = loan.premiumType,
          frequencyId = 'premiumFrequency',
          frequencyLabel = 'Premium frequency',
          frequencyCheckedValue = loan.premiumFrequency,
          validationErrors = validationErrors
        )}}

        {{dayCountRadios.render(
          checkedValue = loan.dayCountBasis,
          errorObj = validationErrors.errorList.dayCountBasis
        )}}

      </div>

    </div>

    <button type="submit" class="govuk-button govuk-!-margin-right-1" data-module="govuk-button" data-cy="submit-button">Preview</button>

    <input
      type="submit"
      formaction="/contract/{{ dealId }}/loan/{{ loan._id }}/save-go-back"
      class="govuk-button govuk-button--secondary"
      data-module="govuk-button"
      value="Save and go back to deal"
      data-cy="save-go-back-button"
    />

  </form>

{% endblock %}
