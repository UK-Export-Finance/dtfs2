{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% extends "index.njk" %}

{% set backLink = { "href": "/utilisation-reports/" + reportId + "/create-record-correction-request/" + feeRecordId } %}

{% block pageTitle %}Check the information before submitting the record correction{% endblock %}

{% block content %}
  <div class="govuk-!-padding-top-7">
      <h1 class="govuk-heading-l" data-cy="main-heading">Record correction</h1>
      <h2 class="govuk-heading-m" data-cy="check-the-information-heading">
        Check the information before submitting the record correction
      </h2>
  </div>

  <div class="govuk-!-padding-top-7">
    <h3 class="govuk-heading-s" data-cy="original-values-heading">Original values</h3>

    {{ govukSummaryList({
      rows: [
        {
          key: {
            text: "Exporter"
          },
          value: {
            text: exporter
          }
        },
        {
          key: {
            text: "Currency"
          },
          value: {
            text: reportedFees.currency
          }
        },
        {
          key: {
            text: "Reported fees"
          },
          value: {
            text: reportedFees.amount
          }
        }
      ],
      attributes: {
        'data-cy': 'original-values-summary-list'
      }
    }) }}
  </div>

  <div class="govuk-!-padding-top-7">
    <h3 class="govuk-heading-s" data-cy="original-values-heading">Original values</h3>

    {{ govukSummaryList({
      rows: [
        {
          key: {
            text: "Error type(s)"
          },
          value: {
            text: formattedReasons
          }
        },
        {
          key: {
            text: "Error summary"
          },
          value: {
            html: (errorSummary | replaceNewLinesWithBrTags)
          }
        },
        {
          key: {
            text: "Old value(s)"
          },
          value: {
            text: formattedOldValues
          }
        },
        {
          key: {
            text: "New values(s)"
          },
          value: {
            text: formattedNewValues
          },
          actions: {
            items: [
              {
                href: backLink.href,
                text: "Change",
                visuallyHiddenText: "new values for record correction",
                attributes: {
                  'data-cy': 'change-record-correction-new-values-link'
                }
              }
            ]
          }
        },
        {
          key: {
            text: "Bank commentary"
          },
          value: {
            html: (bankCommentary | replaceNewLinesWithBrTags)
          },
          actions: {
            items: [
              {
                href: backLink.href,
                text: "Change",
                visuallyHiddenText: "bank commentary for record correction",
                attributes: {
                  'data-cy': 'change-record-correction-bank-commentary-link'
                }
              }
            ]
          }
        }
      ],
      attributes: {
        'data-cy': 'record-correction-details-summary-list'
      }
    }) }}
  </div>

  <div class="govuk-button-group">
    <form method="post">
      <input type="hidden" name="_csrf" value="{{ csrfToken }}"/>
      {{ govukButton({
        text: "Confirm and send",
        attributes: {
          'data-cy': 'continue-button'
        }
      }) }}
    </form>

    {# TODO: Add clear behaviour under a different ticket. Note that this will need changing to be an input with a formaction attribute. #}
    {{ govukButton({
      text: "Cancel record correction",
      href: "/utilisation-report-upload",
      class: "govuk-button govuk-button--secondary",
      attributes: {
        "data-cy":"cancel-button"
      }
    }) }}
  </div>

{% endblock %}
{% block sub_content %}{% endblock %}
