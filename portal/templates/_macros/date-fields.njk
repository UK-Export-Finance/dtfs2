{% from "govuk/components/date-input/macro.njk" import govukDateInput %}

{% macro inputs(id, legend, hint, dayValue, monthValue, yearValue, error, conditionalError) %}

  {% set inputClass = "govuk-input--width-2" %}
  {% set inputErrorClass = "govuk-input--width-2 govuk-input--error" %}

  {% set dateHasAllValues = (dayValue and monthValue and yearValue) %}
  {% set dateDoesNotHaveAllValues = (not dayValue) or (not monthValue) or (not yearValue) %}

  {% set dateError = error or (dateDoesNotHaveAllValues and conditionalError) %}

  {% set dayError = (dateError or (error and not dayValue)) %}
  {% set monthError = (dateError or (error and not monthValue)) %}
  {% set yearError = (dateError or (error and not yearValue)) %}

  {{ govukDateInput({
    id: id,
    namePrefix: id,
    fieldset: {
      legend: {
        text: legend
      }
    },
    hint: {
      html: hint
    },
    errorMessage: dateError and {
      text: dateError.text,
      attributes: {
        'data-cy': id + "-error-message"
      }
    },
    items: [
      {
        classes: (dayError and inputErrorClass) or inputClass,
        name: "day",
        value: dayValue,
        attributes: {
          'data-cy': id + "-day"
        }
      },
      {
        classes: (monthError and inputErrorClass) or inputClass,
        name: "month",
        value: monthValue,
        attributes: {
          'data-cy': id + "-month"
        }
      },
      {
        classes: (yearError and "govuk-input--width-4 govuk-input--error") or "govuk-input--width-4",
        name: "year",
        value: yearValue,
        attributes: {
          'data-cy': id + "-year"
        }
      }
    ]
  }) }}      

{% endmacro %}
